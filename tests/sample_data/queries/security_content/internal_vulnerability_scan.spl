index=something
| tstats `security_content_summariesonly` values(IDS_Attacks.action) as action values(IDS_Attacks.src_category) as src_category values(IDS_Attacks.dest_category) as dest_category count from datamodel=Intrusion_Detection.IDS_Attacks where IDS_Attacks.src IN (10.0.0.0/8,192.168.0.0/16,172.16.0.0/12) IDS_Attacks.severity IN (critical, high, medium) by IDS_Attacks.src IDS_Attacks.severity IDS_Attacks.signature IDS_Attacks.dest IDS_Attacks.dest_port IDS_Attacks.transport span=1s _time
| `drop_dm_object_name("IDS_Attacks")`
| eval gtime=_time
| bin span=1h gtime
| eventstats count as sevCount by severity src
| eventstats count as sigCount by signature src
| eval severity=severity +"("+sevCount+")"
| eval signature=signature +"("+sigCount+")"
| eval dest_port=transport + "/" + dest_port
| stats min(_time) as _time values(action) as action dc(dest) as destCount dc(signature) as sigCount values(signature) values(src_category) as src_category values(dest_category) as dest_category values(severity) as severity values(dest_port) as dest_ports by src gtime
| fields - gtime
| where destCount>25 OR sigCount>25
| `internal_vulnerability_scan_filter`
